<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="ja">

  <head>
     <script type="text/x-mathjax-config">

       MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});

    </script>

    <script type="text/javascript" async 

        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">

    </script>

  </head>

<body>
    <h3>１変数の最小二乗法(Least Squre Method)</h3>

<p>計測値\(y(k)\)に対する最小二乗推定値\(\hat y(k)\)を次式で与えます。</p>
\begin{align}
\hat y(k)=a(n)x(k)~~~~(k=0,1,\cdots,n)
\end{align}

<p>次式の二乗評価式を最小化する\(a(n)\)を求めます。</p>
\begin{align}
S(n)=\frac{1}{2}\sum_{k=0}^{n}\lambda^{n-k}\{\hat y(k)-y(k)\}^2~~~~~~~(0 < \lambda < 1) \label{eq:EvmEqn}
\end{align}

<p>ここに、\(\lambda\)は忘却係数と呼ばれます。
  過去の計測値の影響を小さくするこによってパラメータの変化に対応することに有効です。
  式\eqref{eq:EvmEqn}には次式の漸化式が成立します。</p>

\begin{align}
S(n)=S(n-1)+\lambda e(n-1)^2\label{eq:EvmEqn2}
\end{align}

<p>式\eqref{eq:EvmEqn}を\(a\)で偏微分し、極値をとるものとする。</p>
\begin{align}
\frac{\partial S(n)}{\partial a(n)}&=~\sum_{k=0}^n\lambda^{n-k}\frac{\partial \hat y(n)}{\partial a(n)}\{\hat y(k)-y(k)\}\nonumber\\
&=~\sum_{k=0}^n\lambda^{n-k}x(k)\{\hat y(k)-y(k)\}\nonumber\\
&=~0\nonumber
\end{align}

<p>結局、次式が成立する。</p>
\begin{align}
a(n)=\frac{q(n)}{p(n)}\label{eq:SolOfEqn}
\end{align}

<p>ここに、</p>
\begin{align}
p(n)&=~\sum_{k=0}^n\lambda^{n-k}x(k)^2\label{eq:EqnOfP}\\
q(n)&=~\sum_{k=0}^n\lambda^{n-k}x(k)y(k)\label{eq:EqnOfQ}
\end{align}

<p>式\eqref{eq:SolOfEqn}で最小二乗法による係数\(a(n)\)が決定されます。</p>

<p>さて、ここからが逐次最小二乗法になります。
  式\eqref{eq:EqnOfP}、\eqref{eq:EqnOfQ}には次式の漸化式が成立します。
</p>
\begin{align}
p(n)&=~\lambda p(n-1)+x(n)^2\label{eq:EqnOfP2}\\
q(n)&=~\lambda q(n-1)+x(n)y(n)\label{eq:EqnOfQ2}
\end{align}

<p>式\eqref{eq:EqnOfP2}、\eqref{eq:EqnOfQ2}を式\eqref{eq:SolOfEqn}に代入すると次式が得られます。</p>
\begin{align}
a(n)=\frac{\lambda q(n-1)+x(n)y(n)}{\lambda p(n-1)+x(n)^2}\label{eq:CoefEqn1}
\end{align}

<p>式\eqref{eq:CoefEqn1}の右辺の分子と分母を\(p(n-1)\)で除し、
\(a(n-1)=q(n-1)/p(n-1)\)であることに注意すれば次式が得られる。</p>
\begin{align}
a(n)=\frac{\lambda a(n-1)+\frac{x(n)y(n)}{p(n-1)}}{\lambda+\frac{x(n)^2}{p(n-1)}}\label{eq:CoefEqn2}
\end{align}

<p>式\eqref{eq:CoefEqn1}を整理すると次式が得られます。</p>
\begin{align}
a(n)=a(n-1)+\frac{x(n)}{p(n)}\{y(n)-a(n-1)x(n)\}\label{eq:CoefEqn3}
\end{align}

<p>\(p(n)\)は式\eqref{eq:EqnOfP2}により計算することができますが、
\(p(n)\)の逆数\(r(n)\)を用いて式\eqref{eq:CoefEqn3}を書き換えることができます。
まず、\(r(n)\)の漸化式を導きます。</p>
\begin{align}
r(n)&=~\frac{1}{p(n)}\nonumber\\
&=~\frac{1}{\lambda p(n-1)+x(n)^2}\nonumber\\
&=~\frac{1/p(n-1)}{\lambda+x(n)^2/p(n-1)}\nonumber\\
&=~\frac{r(n-1)}{\lambda+x(n)^2r(n-1)}\nonumber
\end{align}

<p>\(r(n)\)を用いて式\eqref{eq:CoefEqn3}は次式となります。
  したがって、変数\(x(n)\)、\(y(k)\)\((n=1,2,3,...)\)が採取されるときの逐次最小二乗法は次式となります。</p>
\begin{align}
a(n)&=~a(n-1)+r(n)x(n)\{y(n)-a(n-1)x(n)\}\label{eq:CoefEqn4}\\
r(n)&=~\frac{r(n-1)}{\lambda+x(n)^2r(n-1)}\label{eq:CoefEqn5}
\end{align}

<p><a href="https://aoyamakohbo.github.io/Craftlogy/">->TOP</a></p>
</body>

</html>
